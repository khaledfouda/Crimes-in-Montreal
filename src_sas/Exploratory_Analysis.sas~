%let root_dir = D:\CODE\projects\mtl\Crimes-in-Montreal;
libname proj_lib "&root_dir\data\sas";
ods escapechar='^'; /* To allow the abbr ^n for inserting new lines in titles and footnotes.*/
*%let  N = 191611;
* 1. Missing Values Analysis ;
title 'Montreal Crime Study^nExploratory Analysis^n
-----------------------^n1.Missing Values Analysis';
 data missing_table(keep=type location borough pol_div);
	length type $15.;
	set proj_lib.crime_data nobs=n;
	call symputx('N',n, 'G');
	
	retain location 0 borough 0 pol_div 0 ;
	if missing(LONGITUDE)  then Location + 1;
	if missing(ARRONDIS)  then Borough + 1;
	if missing(DIVISION)  then Pol_Div + 1;
	
	if _N_ EQ n then do;
		type = 'Count';
		output;
		Location = put(Location / n,7.2);
		Borough = put(Borough / n,7.2);
		pol_div = put(Pol_Div / n,7.2);
		type='Percent';
		output;
	end;
run;
PROC TRANSPOSE DATA=missing_table out=missing_table;
	ID TYPE;
run;

proc print data=missing_table;
	format Percent percent7.1 Count comma.;
run;